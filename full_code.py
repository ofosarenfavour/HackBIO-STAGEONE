# -*- coding: utf-8 -*-
"""full_code

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1H-g2vKZ00d7En4lcYDp7VAKxfKOPeXUw
"""

!pip install pandas
!pip install numpy
!pip install matplotlib
!pip install seaborn
!pip install sklearn

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import sklearn

# import file link from HackBio
url_heatmap = "https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_top_deg_normalized_counts.csv"
url_volcano = "https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_deg_chr22_with_significance.csv"
url_scatter_densityplot ="https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/data-3.csv"

# load datasets
heatmap_df = pd.read_csv(url_heatmap)
volcano_df = pd.read_csv(url_volcano)
scatter_density_df = pd.read_csv(url_scatter_densityplot)

# Select top 20 genes (example)
top_genes = heatmap_df.head(20)

# Set the 'Unnamed: 0' column as the index
top_genes = top_genes.set_index('Unnamed: 0')

# Plot the clustered heatmap
plt.figure(figsize=(10, 6))
sns.heatmap(top_genes, cmap="Blues", annot=False)
plt.title("Clustered Heatmap of Top Differentially Expressed Genes (HBR vs UHR)")
plt.xlabel("Samples")
plt.ylabel("Genes")
plt.show()
print("Heatmap dataset shape:", heatmap_df.shape)
print("Number of genes:", heatmap_df.shape[0])
print("Number of samples:", heatmap_df.shape[1])

# Ensure correct columns
# Columns must include: 'log2FoldChange' and 'padj'
volcano_df = volcano_df.dropna(subset=['log2FoldChange', 'PAdj'])

# Create significance column
volcano_df['significance'] = 'Not significant'
volcano_df.loc[(volcano_df['log2FoldChange'] > 1) & (volcano_df['PAdj'] < 0.05), 'significance'] = 'Upregulated'
volcano_df.loc[(volcano_df['log2FoldChange'] < -1) & (volcano_df['PAdj'] < 0.05), 'significance'] = 'Downregulated'

# Plot
plt.figure(figsize=(8, 6))
sns.scatterplot(
    data=volcano_df,
    x='log2FoldChange',
    y=-np.log10(volcano_df['PAdj']),
    hue='significance',
    palette={'Upregulated': 'green', 'Downregulated': 'orange', 'Not significant': 'grey'},
    alpha=0.7
)

# Add vertical threshold lines
plt.axvline(x=1, color='black', linestyle='--')
plt.axvline(x=-1, color='black', linestyle='--')

plt.title("Volcano Plot of Differentially Expressed Genes")
plt.xlabel("log2(Fold Change)")
plt.ylabel("-log10(Adjusted p-value)")
plt.legend(title="Significance")
plt.show()
print("Number of Upregulated genes:", sum(volcano_df['significance'] == 'Upregulated'))
print("Number of Downregulated genes:", sum(volcano_df['significance'] == 'Downregulated'))
print("Number of Not significant genes:", sum(volcano_df['significance'] == 'Not significant'))

plt.figure(figsize=(8,6))
sns.scatterplot(
    data=scatter_density_df,
    x='radius_mean',
    y='texture_mean',
    hue='diagnosis',
    palette={'M': 'red', 'B': 'blue'}
)
plt.title('Scatter Plot: Radius vs Texture')
plt.xlabel('Radius Mean')
plt.ylabel('Texture Mean')
plt.grid(True)
plt.show()
print("=== Scatter Plot (Radius vs Texture) ===")
print("This plot shows how texture_mean varies with radius_mean, colored by diagnosis.\n")

features = [
    'radius_mean', 'texture_mean', 'perimeter_mean',
    'area_mean', 'smoothness_mean', 'compactness_mean'
]
corr = scatter_density_df[features].corr()

plt.figure(figsize=(8,6))
sns.heatmap(corr, annot=True, cmap='coolwarm')
plt.title('Correlation Heatmap of Key Features')
plt.show()
print("=== Correlation Heatmap ===")
print("This heatmap shows correlations between six key features.\n")

plt.figure(figsize=(8,6))
sns.scatterplot(
    data=scatter_density_df,
    x='smoothness_mean',
    y='compactness_mean',
    hue='diagnosis',
    palette={'M': 'red', 'B': 'blue'}
)
plt.title('Scatter Plot: Smoothness vs Compactness')
plt.xlabel('Smoothness Mean')
plt.ylabel('Compactness Mean')
plt.grid(True)
plt.show()
print("=== Scatter Plot (Smoothness vs Compactness) ===")
print("This plot compares smoothness_mean and compactness_mean for each diagnosis.\n")

plt.figure(figsize=(8,6))
sns.kdeplot(
    data=scatter_density_df[scatter_density_df['diagnosis'] == 'M'],
    x='area_mean',
    label='Malignant',
    fill=True,
    alpha=0.5
)
sns.kdeplot(
    data=scatter_density_df[scatter_density_df['diagnosis'] == 'B'],
    x='area_mean',
    label='Benign',
    fill=True,
    alpha=0.5
)
plt.title('Density Plot: Area Mean Distribution')
plt.xlabel('Area Mean')
plt.ylabel('Density')
plt.legend()
plt.show()
print("=== Density Plot (Area Mean Distribution) ===")
print("This plot shows the area_mean distribution for malignant and benign samples.\n")

# Function to calculate Hamming Distance

def hamming_distance(str1,str2):
  """Returns the hamming distance between two strings"""
  # Make both strings the same length by padding with spaces (if needed)
  max_len = max(len(str1),len(str2))
  str1=str1.ljust(max_len)
  str2=str2.ljust(max_len)

  distance=0
  for i in range(max_len):
      if str1[i] != str2[i]:
        distance+= 1
  return distance

# Example for your details
slack_username = "Ofosaren Favour"
twitter_handle = "@ofosarenfavour"

#calculate the Hamming distance
distance = hamming_distance(slack_username, twitter_handle)

print(f"The Hamming distance between {slack_username} and {twitter_handle} is {distance}")

def dna_to_protein(dna_seq):
    """Translate a DNA sequence to a protein sequence."""

    # Standard genetic code dictionary
    codon_table = {
        'ATA':'I', 'ATC':'I', 'ATT':'I', 'ATG':'M',
        'ACA':'T', 'ACC':'T', 'ACG':'T', 'ACT':'T',
        'AAC':'N', 'AAT':'N', 'AAA':'K', 'AAG':'K',
        'AGC':'S', 'AGT':'S', 'AGA':'R', 'AGG':'R',
        'CTA':'L', 'CTC':'L', 'CTG':'L', 'CTT':'L',
        'CCA':'P', 'CCC':'P', 'CCG':'P', 'CCT':'P',
        'CAC':'H', 'CAT':'H', 'CAA':'Q', 'CAG':'Q',
        'CGA':'R', 'CGC':'R', 'CGG':'R', 'CGT':'R',
        'GTA':'V', 'GTC':'V', 'GTG':'V', 'GTT':'V',
        'GCA':'A', 'GCC':'A', 'GCG':'A', 'GCT':'A',
        'GAC':'D', 'GAT':'D', 'GAA':'E', 'GAG':'E',
        'GGA':'G', 'GGC':'G', 'GGG':'G', 'GGT':'G',
        'TCA':'S', 'TCC':'S', 'TCG':'S', 'TCT':'S',
        'TTC':'F', 'TTT':'F', 'TTA':'L', 'TTG':'L',
        'TAC':'Y', 'TAT':'Y', 'TAA':'_', 'TAG':'_',
        'TGC':'C', 'TGT':'C', 'TGA':'_', 'TGG':'W',


    }
    protein_seq = ''
    # Translate each codon (3 DNA bases)
    for i in range(0, len(dna_seq), 3):
        codon = dna_seq[i:i+3]
        if codon in codon_table:
            protein_seq += codon_table[codon]
    return protein_seq

dna_seq = 'ATGGAGGAGCCGCAGTCAGATCCTAGCGTCGAGC'
protein_seq = dna_to_protein(dna_seq)
print("protein sequence:",protein_seq)